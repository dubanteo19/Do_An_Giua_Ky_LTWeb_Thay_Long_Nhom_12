<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css">
    <link rel="stylesheet" href="styles/login.css">
    <link rel="stylesheet" type="text/css" href="styles/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="styles/base.css">
    <link rel="stylesheet" type="text/css" href="styles/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="styles/news.css">
    <link rel="stylesheet" type="text/css" href="styles/footer.css">
    <link rel="stylesheet" type="text/css" href="styles/nav.css">
    <script type="text/javascript" src="javascripts/jquery-3.7.1.js"></script>
    <title></title>
    <style>
        .h_recover{
            display: none;
        }
    </style>
</head>
<body>
<iframe onload="resizeIframe(this,320)" src="top-title.html?title=Đăng nhập"></iframe>
<section class="section">
    <div class="container">
        <div class="wrap_background_aside">
            <div class="row">
                <div style="margin: auto;" class="col-lg-4 col-md-6 col-sm-12 col-12 col-xl-4 offset-xl-4 offset-lg-4 offset-md-3 offset-xl-3 ">
                    <div class="row no-margin align-items-center" style="background: #fff;border-radius: 5px;">
                        <div class="page-login clearfix">
                            <div class="wpx">
                                <h1 class="title_heads text-center"><span>Đăng nhập</span></h1>
                                <div id="overlay">
                                    <div class="loader"></div>
                                </div>
                                <div id="error-message" style="color: red;"></div>
                                <div id="login" class="section">
                                    <form method="post" action="signup" id="customer_login" accept-charset="UTF-8"><input name="FormType" type="hidden" value="customer_login">
									</span>
                                        <div class="form-signup clearfix">
                                            <fieldset class="form-group">
                                                <input type="email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,63}$" class="form-input" value="" name="email" id="email" placeholder="Email" required="">
                                            </fieldset>
                                            <fieldset class="form-group">
                                                <input type="password" class=" form-input" value="" name="password" id="customer_password" placeholder="Mật khẩu" required="">
                                                <div id="eye">
                                                    <i class="far fa-eye"></i>
                                                </div>
                                            </fieldset>
                                            <div class="pull-xs-left justify-content-center text-center">
                                                <button type="submit" value="Đăng ký" class="btn btn-green w-100 my-2" style="color: #fff">Đăng nhập</button>
                                                <span class="block a-center quenmk ">Quên mật khẩu</span>
                                            </div>
                                        </div>
                                    </form>
                                    <div class="h_recover" style="">
                                        <div id="recover-password" class="form-signup page-login">
                                            <form method="post"id="recover_customer_password" accept-charset="UTF-8">
                                                <div class="error" style="color: red"></div>
                                                <div class="form-signup clearfix">
                                                    <fieldset class="form-group">
                                                        <input type="email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,63}$" class="form-control" value="" name="Email" id="recover-email" placeholder="Email" required="">
                                                    </fieldset>
                                                </div>
                                                <div class="action_bottom">
                                                    <input class="btn btn-hover w-100 " style="margin-top: 0px;background-color: #2c3034; border: none" type="submit" value="Lấy lại mật khẩu">
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>

                                <div class="block social-login--facebooks pt-3"style="justify-items: center; text-align: center">
                                    <p>Không có tài khoản? <a href="#register" id="register-link">Đăng ký</a></p>
                                    <p class="text-center">
                                        Hoặc đăng nhập bằng
                                    </p>
                                    <a href="javascript:void(0)" class="social-login--facebook" onclick="loginFacebook()"><img width="129px" height="37px" alt="facebook-login-button" src="images/logo/fb-btn.svg"></a>
                                    <a href="javascript:void(0)" class="social-login--google" onclick="loginGoogle()"><img width="129px" height="37px" alt="google-login-button" src="images/logo/gp-btn.svg"></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<footer>
    <iframe src="footer.html" onload="resizeIframe(this,339)"></iframe>
</footer>
</body>
<script type="text/javascript" src="javascripts/main.js"></script>
<script>
    $(document).ready(function() {
        $('#register-link').on('click', function(event) {
            event.preventDefault();
            window.location.href = 'signup.html';
        });

        var quenMatKhauButton = $('.quenmk');
        var hRecoverElement = $('.h_recover');
        var recoverForm = $('#recover_customer_password');
        var errorElement = $('.error');

        quenMatKhauButton.on('click', function(event) {
            event.preventDefault();
            hRecoverElement.slideDown();
            errorElement.text('');
        });

        recoverForm.on('submit', function(event) {
            event.preventDefault();

            var emailValue = $('#recover-email').val();
            var email = localStorage.getItem('email');
            if (emailValue !== email) {
                displayError('Email không tồn tại trong hệ thống.');
                return;
            }
            else{
                var newPassword = generateRandomPassword(8);
                localStorage.setItem('password', newPassword);
                alert('Mật khẩu mới của bạn là: ' + newPassword);
                hRecoverElement.slideUp();
            }
            function generateRandomPassword(length) {
                var charset = '0123456789';
                var password = '';
                for (var i = 0; i < length; i++) {
                    var randomIndex = Math.floor(Math.random() * charset.length);
                    password += charset[randomIndex];
                }
                return password;
            }
        });

        function displayError(errorMessage) {
            errorElement.text(errorMessage);
        }
    });
    var CORRECT_ADMIN = localStorage.getItem('admin@gmail.com');
    var CORRECT_PASS_ADMIN = localStorage.getItem('123');

    var CORRECT_USER = localStorage.getItem('email');
    var CORRECT_PASS = localStorage.getItem('password');

    var inputUsername = document.getElementById('email');
    var inputPassword = document.getElementById('customer_password');

    var formLogin = document.getElementById('customer_login');

    if (formLogin.attachEvent) {
        formLogin.attachEvent('submit', onFormSubmit);
    } else {
        formLogin.addEventListener('submit', onFormSubmit);
    }

    function onFormSubmit(e) {
        e.preventDefault();
        var username = inputUsername.value;
        var password = inputPassword.value;
        var errorMessageElement = document.getElementById('error-message');
        if (username == CORRECT_USER && password == CORRECT_PASS) {
            var overlay = document.getElementById('overlay');
            overlay.style.display = 'block';

            // Tạo hiệu ứng loading trong 2 giây (có thể thay đổi thời gian tùy ý)
            setTimeout(function() {
                // Nếu thông tin đúng, chuyển hướng đến trang khác
                window.location.href = 'index.html';
            }, 2000);
        } else {
            errorMessageElement.textContent = 'Sai tên đăng nhập hoặc mật khẩu. Vui lòng thử lại.';
        }
        if(username == CORRECT_ADMIN && password ==CORRECT_PASS_ADMIN){
            var overlay = document.getElementById('overlay');
            overlay.style.display = 'block';

            // Tạo hiệu ứng loading trong 2 giây (có thể thay đổi thời gian tùy ý)
            setTimeout(function() {
                // Nếu thông tin đúng, chuyển hướng đến trang khác
                window.location.href = 'admin/admin.html';
            }, 2000);
        }
    }

    $(document).ready(function() {
        $('#eye').click(function() {
            $(this).toggleClass('open');
            $(this).children('i').toggleClass('fa-eye-slash fa-eye');
            if ($(this).hasClass('open')) {
                $(this).prev().attr('type', 'text');
            } else {
                $(this).prev().attr('type', 'password');
            }
        });
    });

</script>
</html>